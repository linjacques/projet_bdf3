2025-06-29 12:51:28,036 [INFO]  Lecture de la table Hive : default.preprocessed_accidents_for_ml
2025-06-29 12:51:37,014 [INFO]  100% des données chargées ...
2025-06-29 12:51:37,066 [INFO]  Suppression des lignes avec valeurs nulles...
2025-06-29 12:51:37,146 [INFO]  Assemblage des features (32 colonnes numériques)...
2025-06-29 12:51:38,941 [INFO]  Split (80/20)...
2025-06-29 12:51:38,986 [INFO]  Entraînement du modèle RandomForestClassifier...
2025-06-29 13:06:47,947 [INFO]  Prédiction sur toutes les données...
2025-06-29 13:06:48,054 [INFO]  Ajout de la colonne prediction_classe...
2025-06-29 13:06:48,218 [INFO]  Évaluation de l’accuracy sur données test...
2025-06-29 13:07:33,187 [INFO]  Accuracy du modèle Random Forest : 0.7969
2025-06-29 13:07:33,189 [INFO]  Aperçu du résultat final (5 lignes max) :
2025-06-29 13:07:34,279 [INFO] ID	Severity	Humidity(%)	Pressure(in)	Distance_km	Temperature(C)	Wind_Chill(C)	Visibility_km	Wind_Speed_kmh	Precipitation(cm)	duration_minutes_accident	duration_minutes_record_weather	wind_dir_sin	wind_dir_cos	Timezone_index	State_index	Weather_Condition_index	Amenity_num	Bump_num	Crossing_num	Give_Way_num	Junction_num	No_Exit_num	Railway_num	Roundabout_num	Station_num	Stop_num	Traffic_Calming_num	Traffic_Signal_num	Turning_Loop_num	Sunrise_Sunset_num	Civil_Twilight_num	Nautical_Twilight_num	Astronomical_Twilight_num	prediction_classe
2025-06-29 13:07:34,280 [INFO] A-160017	3	70.0	30.05	0.0	27.0	16.67	16.09	11.1	0.0	30.0	3.45	0.0	0.0	2.0	32.0	3.0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	1	1	2
2025-06-29 13:07:34,281 [INFO] A-160047	3	100.0	29.95	0.0	19.39	16.67	3.22	11.1	0.58	60.0	-12.87	0.0	1.0	2.0	32.0	38.0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	1	1	1	2
2025-06-29 13:07:34,281 [INFO] A-160090	2	88.0	29.73	0.0	28.28	16.67	16.09	12.37	0.0	30.0	-25.85	0.0	0.0	2.0	32.0	3.0	0	0	0	0	0	0	0	0	0	0	0	1	0	1	1	1	1	2
2025-06-29 13:07:34,282 [INFO] A-160100	3	61.0	29.95	0.0	22.22	16.67	16.09	11.1	0.0	45.0	-25.5	-0.3826834323650904	0.9238795325112865	2.0	32.0	1.0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	1	1	2
2025-06-29 13:07:34,283 [INFO] A-160182	3	64.83	29.54	0.0	16.48	16.67	14.63	12.37	0.0	30.0	6.33	0.0	1.0	2.0	32.0	8.0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	1	1	2
2025-06-29 13:07:38,782 [INFO]  Nombre de lignes du df : 7728394
2025-06-29 13:07:38,783 [INFO]  Sauvegarde Hive : default.predicted_severity
2025-06-29 13:09:38,500 [INFO]  Temps total d'exécution : 2383.63 secondes
2025-06-29 13:09:38,500 [INFO]  Arrêt de la SparkSession.
2025-06-29 13:09:39,167 [INFO] Closing down clientserver connection
