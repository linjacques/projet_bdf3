2025-06-29 13:36:11,136 [INFO] Logger initialisé, les logs seront enregistrés ici : logs/join2025-06-29_13-36.log
2025-06-29 13:36:28,431 [INFO] SparkSession initialisée avec support Hive.
2025-06-29 13:36:28,432 [INFO] Lecture de la table 'predicted_severity'...
2025-06-29 13:36:36,532 [INFO] Table df_ml chargée avec 7728394 lignes.
2025-06-29 13:36:36,536 [INFO] Lecture de la table 'preprocessed_accidents_for_join'...
2025-06-29 13:36:37,503 [INFO] Table df_join chargée avec 7705148 lignes.
2025-06-29 13:36:37,552 [INFO] Colonnes sélectionnées dans df_ml : ID et prediction_classe.
2025-06-29 13:36:37,553 [INFO] Jointure des deux DataFrames sur 'ID' (inner join)...
2025-06-29 13:36:56,668 [INFO] Jointure effectuée avec succès. Nombre de lignes finales : 7705148
2025-06-29 13:36:56,669 [INFO] Aperçu des premières lignes après jointure :
2025-06-29 13:37:29,703 [INFO] Row(ID='A-1000044', Severity=3, Start_Lat=40.131401000000004, Start_Lng=-76.796501, End_Lat=None, End_Lng=None, Description='Accident and fire department activity on I-83 Northbound at Exit 32 PA-382 Old Trail Rd.', Street='Old Trail Rd', City='York Haven', State='PA', Zipcode='17370', Timezone='US/Eastern', Airport_Code='KMDT', Humidity(%)=25.0, Pressure(in)=29.64, Weather_Condition='Partly Cloudy', Amenity=False, Bump=False, Crossing=False, Give_Way=False, Junction=False, No_Exit=False, Railway=False, Roundabout=False, Station=False, Stop=False, Traffic_Calming=False, Traffic_Signal=False, Turning_Loop=False, Sunrise_Sunset='Day', Civil_Twilight='Day', Nautical_Twilight='Day', Astronomical_Twilight='Day', Distance_km=0.0, Temperature(C)=25.56, Wind_Chill(C)=25.56, Visibility_km=16.09, Wind_Speed_kmh=11.27, Precipitation(cm)=0.0, duration_minutes_accident=62.62, duration_minutes_record_weather=23.52, Wind_Direction_clean='W', prediction_classe=2)
2025-06-29 13:37:29,705 [INFO] Row(ID='A-1000088', Severity=3, Start_Lat=39.211849, Start_Lng=-84.4617, End_Lat=None, End_Lng=None, Description='Left lane blocked due to accident on I-75 Southbound at Galbraith Rd.', Street='I-75 S', City='Cincinnati', State='OH', Zipcode='45215', Timezone='US/Eastern', Airport_Code='KLUK', Humidity(%)=86.0, Pressure(in)=29.54, Weather_Condition='Fair', Amenity=False, Bump=False, Crossing=False, Give_Way=False, Junction=False, No_Exit=False, Railway=False, Roundabout=False, Station=False, Stop=False, Traffic_Calming=False, Traffic_Signal=False, Turning_Loop=False, Sunrise_Sunset='Day', Civil_Twilight='Day', Nautical_Twilight='Day', Astronomical_Twilight='Day', Distance_km=0.0, Temperature(C)=15.56, Wind_Chill(C)=15.56, Visibility_km=16.09, Wind_Speed_kmh=0.0, Precipitation(cm)=0.0, duration_minutes_accident=44.12, duration_minutes_record_weather=-22.33, Wind_Direction_clean='UNKNOWN', prediction_classe=2)
2025-06-29 13:37:29,705 [INFO] Row(ID='A-1000100', Severity=3, Start_Lat=39.03141, Start_Lng=-84.607407, End_Lat=None, End_Lng=None, Description='Entry ramp to I-71 Southbound at Exit 84 from I-275 Westbound lane blocked due to accident.', Street='I-71 S', City='Erlanger', State='KY', Zipcode='41018', Timezone='US/Eastern', Airport_Code='KCVG', Humidity(%)=39.0, Pressure(in)=29.1, Weather_Condition='Partly Cloudy', Amenity=False, Bump=False, Crossing=False, Give_Way=False, Junction=False, No_Exit=False, Railway=False, Roundabout=False, Station=False, Stop=False, Traffic_Calming=False, Traffic_Signal=False, Turning_Loop=False, Sunrise_Sunset='Day', Civil_Twilight='Day', Nautical_Twilight='Day', Astronomical_Twilight='Day', Distance_km=2.75, Temperature(C)=27.78, Wind_Chill(C)=27.78, Visibility_km=16.09, Wind_Speed_kmh=9.66, Precipitation(cm)=0.0, duration_minutes_accident=76.18, duration_minutes_record_weather=9.18, Wind_Direction_clean='UNKNOWN', prediction_classe=2)
2025-06-29 13:37:29,706 [INFO] Row(ID='A-1000154', Severity=2, Start_Lat=35.204861, Start_Lng=-80.835892, End_Lat=None, End_Lng=None, Description='Lane blocked due to accident on Kings Dr at Morehead St.', Street='S Kings Dr', City='Charlotte', State='NC', Zipcode='28204', Timezone='US/Eastern', Airport_Code='KCLT', Humidity(%)=49.0, Pressure(in)=29.29, Weather_Condition='Fair', Amenity=False, Bump=False, Crossing=True, Give_Way=False, Junction=False, No_Exit=False, Railway=False, Roundabout=False, Station=False, Stop=False, Traffic_Calming=False, Traffic_Signal=True, Turning_Loop=False, Sunrise_Sunset='Day', Civil_Twilight='Day', Nautical_Twilight='Day', Astronomical_Twilight='Day', Distance_km=0.0, Temperature(C)=22.22, Wind_Chill(C)=22.22, Visibility_km=16.09, Wind_Speed_kmh=11.27, Precipitation(cm)=0.0, duration_minutes_accident=89.73, duration_minutes_record_weather=-28.98, Wind_Direction_clean='N', prediction_classe=2)
2025-06-29 13:37:29,707 [INFO] Row(ID='A-1000208', Severity=2, Start_Lat=35.2369, Start_Lng=-80.73786899999998, End_Lat=None, End_Lng=None, Description='Accident on Milton Rd at Sharon Amity Rd.', Street='N Sharon Amity Rd', City='Charlotte', State='NC', Zipcode='28215', Timezone='US/Eastern', Airport_Code='KJQF', Humidity(%)=41.0, Pressure(in)=29.33, Weather_Condition='Fair', Amenity=False, Bump=False, Crossing=False, Give_Way=False, Junction=False, No_Exit=False, Railway=False, Roundabout=False, Station=False, Stop=False, Traffic_Calming=False, Traffic_Signal=True, Turning_Loop=False, Sunrise_Sunset='Night', Civil_Twilight='Day', Nautical_Twilight='Day', Astronomical_Twilight='Day', Distance_km=0.0, Temperature(C)=22.78, Wind_Chill(C)=22.78, Visibility_km=16.09, Wind_Speed_kmh=0.0, Precipitation(cm)=0.0, duration_minutes_accident=159.28, duration_minutes_record_weather=3.57, Wind_Direction_clean='UNKNOWN', prediction_classe=2)
2025-06-29 13:37:29,708 [INFO] Row(ID='A-1000245', Severity=3, Start_Lat=36.76247, Start_Lng=-76.26814300000002, End_Lat=None, End_Lng=None, Description='One lane blocked due to accident on I-464 Southbound at Exit 1.', Street='I-464 S', City='Chesapeake', State='VA', Zipcode='23320', Timezone='US/Eastern', Airport_Code='KCPK', Humidity(%)=31.0, Pressure(in)=29.99, Weather_Condition='Fair', Amenity=False, Bump=False, Crossing=False, Give_Way=False, Junction=True, No_Exit=False, Railway=False, Roundabout=False, Station=False, Stop=False, Traffic_Calming=False, Traffic_Signal=False, Turning_Loop=False, Sunrise_Sunset='Day', Civil_Twilight='Day', Nautical_Twilight='Day', Astronomical_Twilight='Day', Distance_km=0.0, Temperature(C)=25.0, Wind_Chill(C)=25.0, Visibility_km=11.27, Wind_Speed_kmh=12.87, Precipitation(cm)=0.0, duration_minutes_accident=88.55, duration_minutes_record_weather=-7.1, Wind_Direction_clean='N', prediction_classe=2)
2025-06-29 13:37:29,708 [INFO] Row(ID='A-1000263', Severity=2, Start_Lat=36.818932000000004, Start_Lng=-76.43319699999998, End_Lat=None, End_Lng=None, Description='Left lane closed due to accident on VA-337 Portsmouth Blvd Westbound at I-664.', Street='Portsmouth Blvd', City='Chesapeake', State='VA', Zipcode='23321', Timezone='US/Eastern', Airport_Code='KPVG', Humidity(%)=48.0, Pressure(in)=29.96, Weather_Condition='Fair', Amenity=False, Bump=False, Crossing=False, Give_Way=False, Junction=False, No_Exit=False, Railway=False, Roundabout=False, Station=False, Stop=False, Traffic_Calming=False, Traffic_Signal=False, Turning_Loop=False, Sunrise_Sunset='Day', Civil_Twilight='Day', Nautical_Twilight='Day', Astronomical_Twilight='Day', Distance_km=0.0, Temperature(C)=25.56, Wind_Chill(C)=25.56, Visibility_km=16.09, Wind_Speed_kmh=22.53, Precipitation(cm)=0.0, duration_minutes_accident=107.55, duration_minutes_record_weather=-14.68, Wind_Direction_clean='NE', prediction_classe=2)
2025-06-29 13:37:29,711 [INFO] Row(ID='A-1000406', Severity=2, Start_Lat=28.341419000000002, Start_Lng=-82.231712, End_Lat=None, End_Lng=None, Description='Accident on FL-52 at Janke Dr.', Street='State Road 52', City='Dade City', State='FL', Zipcode='33525', Timezone='US/Eastern', Airport_Code='KZPH', Humidity(%)=89.0, Pressure(in)=29.89, Weather_Condition='Fair', Amenity=False, Bump=False, Crossing=False, Give_Way=False, Junction=False, No_Exit=False, Railway=False, Roundabout=False, Station=False, Stop=False, Traffic_Calming=False, Traffic_Signal=False, Turning_Loop=False, Sunrise_Sunset='Day', Civil_Twilight='Day', Nautical_Twilight='Day', Astronomical_Twilight='Day', Distance_km=0.0, Temperature(C)=25.0, Wind_Chill(C)=25.0, Visibility_km=16.09, Wind_Speed_kmh=4.83, Precipitation(cm)=0.0, duration_minutes_accident=44.72, duration_minutes_record_weather=2.95, Wind_Direction_clean='SSE', prediction_classe=2)
2025-06-29 13:37:29,713 [INFO] Row(ID='A-1000412', Severity=4, Start_Lat=28.359688000000002, Start_Lng=-81.520416, End_Lat=None, End_Lng=None, Description='Right lane blocked due to accident on I-4 Eastbound from Exit 64 US-192 Irlo Bronson Memorial Hwy to Exit 67 FL-536.', Street='Epcot Center Dr E', City='Orlando', State='FL', Zipcode='32821', Timezone='US/Eastern', Airport_Code='KMCO', Humidity(%)=59.0, Pressure(in)=29.92, Weather_Condition='Mostly Cloudy', Amenity=False, Bump=False, Crossing=False, Give_Way=False, Junction=False, No_Exit=False, Railway=False, Roundabout=False, Station=False, Stop=False, Traffic_Calming=False, Traffic_Signal=False, Turning_Loop=False, Sunrise_Sunset='Day', Civil_Twilight='Day', Nautical_Twilight='Day', Astronomical_Twilight='Day', Distance_km=3.35, Temperature(C)=29.44, Wind_Chill(C)=29.44, Visibility_km=16.09, Wind_Speed_kmh=4.83, Precipitation(cm)=0.0, duration_minutes_accident=137.98, duration_minutes_record_weather=11.75, Wind_Direction_clean='S', prediction_classe=2)
2025-06-29 13:37:29,713 [INFO] Row(ID='A-1000461', Severity=3, Start_Lat=33.957283000000004, Start_Lng=-84.516869, End_Lat=None, End_Lng=None, Description='Left lane blocked due to accident on I-75 Southbound before Marietta Pkwy.', Street='GA-401 S', City='Marietta', State='GA', Zipcode='30062', Timezone='US/Eastern', Airport_Code='KMGE', Humidity(%)=58.0, Pressure(in)=28.93, Weather_Condition='Fair', Amenity=False, Bump=False, Crossing=False, Give_Way=False, Junction=False, No_Exit=False, Railway=False, Roundabout=False, Station=False, Stop=False, Traffic_Calming=False, Traffic_Signal=False, Turning_Loop=False, Sunrise_Sunset='Day', Civil_Twilight='Day', Nautical_Twilight='Day', Astronomical_Twilight='Day', Distance_km=0.0, Temperature(C)=23.33, Wind_Chill(C)=23.33, Visibility_km=16.09, Wind_Speed_kmh=4.83, Precipitation(cm)=0.0, duration_minutes_accident=90.95, duration_minutes_record_weather=13.47, Wind_Direction_clean='NNE', prediction_classe=2)
2025-06-29 13:37:29,714 [INFO] Enregistrement du résultat dans la table Hive : default.final_joined_accidents
2025-06-29 13:37:29,714 [INFO] Sauvegarde dans la table Hive : default.final_joined_accidents
2025-06-29 13:39:09,266 [INFO] Données enregistrées dans Hive sous : default.final_joined_accidents
2025-06-29 13:39:09,266 [INFO] Table sauvegardée avec succès.
2025-06-29 13:39:10,042 [INFO] SparkSession arrêtée.
2025-06-29 13:39:10,063 [INFO] Closing down clientserver connection
